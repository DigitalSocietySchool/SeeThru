"use strict";angular.module("ecosenseUiApp",["ngAnimate","ngCookies","ngResource","ngRoute","ngSanitize","ngTouch"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl",controllerAs:"main"}).otherwise({redirectTo:"/"})}]).run(["$rootScope","$location","$cookies",function(a,b,c){a.$on("$routeChangeStart",function(a,b,c){})}]),angular.module("ecosenseUiApp").controller("MainCtrl",["$scope","apiService","$routeParams",function(a,b,c){}]),angular.module("ecosenseUiApp").factory("apiService",["$http","$q","$rootScope","$cookies","authService","userModel",function(a,b,c,d,e,f){c.baseURL="//localhost/ecosense-platform/public/";var g=d.get("userToken");"undefined"!=typeof g&&(e.setToken(g),c.loggedIn=!0);var h="//localhost/ecosense-platform/public/",i=function(b,c){return a({method:"get",url:n(b+m(c))})},j=function(b,c){return a({method:"POST",url:n(b),data:c})},k=function(b,c){return a({method:"PUT",url:n(b),data:c})},l=function(b){return a({method:"DELETE",url:n(b)})},m=function(a){var b="";if(null!==a){var c=0;for(var d in a){var e="&";0===c&&(e="?"),b+=e+d+"="+encodeURI(a[d]),c++}}return b},n=function(a){var b=e.getToken();if(null!==b){var c="&";return-1===a.indexOf("?")&&(c="?"),a+=c+"token="+b}return a};return{login:function(a){return b(function(b,c){return j(h+"login",a).then(function(a){200===a.data.status&&null===a.data.error?(e.setToken(a.data.result.token),b(a)):c(a.data.error)})["catch"](function(a){c(a)})})},getAuthenticatedUser:function(){return b(function(a,b){return i(h+"authuser").then(function(d){if(200===d.data.status&&null===d.data.error){var e=d.data.result.user;c.user=e,f.setUser(e),a(e)}else b(d.data.error)})["catch"](function(a){b(a)})})},getSingle:function(a,c,d){return b(function(b,e){return i(h+a+"/"+c,d).then(function(a){200===a.data.status&&null===a.data.error?b(a.data.result):e(a.data.error)})["catch"](function(a){e(a)})})},getMultiple:function(a,c){return b(function(b,d){return i(h+a,c).then(function(a){200===a.data.status&&null===a.data.error?b(a.data.result):d(a.data.error)})["catch"](function(a){d(a)})})},createObject:function(a,c){return b(function(b,d){return j(h+a,c).then(function(a){200===a.data.status&&null===a.data.error?b(a.data.result):d(a.data.error)})["catch"](function(a){d(a)})})},updateObject:function(a,c,d){return b(function(b,e){return k(h+a+"/"+c,d).then(function(a){200===a.data.status&&null===a.data.error?b(a.data.result):e(a.data.error)})["catch"](function(a){e(a)})})},deleteObject:function(a,c){return b(function(b,d){return l(h+a+"/"+c).then(function(a){200===a.data.status&&null===a.data.error?b(a.data.result):d(a.data.error)})["catch"](function(a){d(a)})})}}}]),angular.module("ecosenseUiApp").directive("loginForm",["$location","apiService",function(a,b){return{templateUrl:"views/partials/loginform.html",restrict:"E",link:function(c,d,e){c.incorrectPassword=!1,c.serverError=!1,c.loading=!1,c.submit=function(d,e){e.$valid&&(c.loading=!0,b.login(d).then(function(d){200===d.data.status&&(console.log("Successful login, grabbing user"),c.incorrectPassword=!1,c.serverError=!1,b.getAuthenticatedUser().then(function(b){console.log("Grabbed user, redirecting"),a.path("/dashboard")})["catch"](function(a){}))})["catch"](function(a){c.loading=!1,401===a.status?c.incorrectPassword=!0:c.serverError=!0,console.error("error",a)}))}}}}]),angular.module("ecosenseUiApp").directive("navbar",["$location","$rootScope","$cookies","apiService","authService","userModel",function(a,b,c,d,e,f){return{templateUrl:"views/partials/navbar.html",restrict:"E",link:function(a,b,c){a.scrollDown=function(a){console.log(a)}}}}]),angular.module("ecosenseUiApp").directive("citizendash",["$rootScope",function(a){return{templateUrl:"views/partials/citizendashboard.html",restrict:"E",scope:{data:"="},link:function(b,c,d){b.baseURL=a.baseURL}}}]),angular.module("ecosenseUiApp").directive("collectordash",function(){return{templateUrl:"views/partials/collectordashboard.html",restrict:"E",scope:{data:"="},link:function(a,b,c){}}}),angular.module("ecosenseUiApp").directive("bsActiveLink",["$location",function(a){return{restrict:"A",replace:!1,link:function(b,c){b.$on("$routeChangeSuccess",function(){var b=["/#"+a.path(),"#"+a.path(),a.path()],d=!1;angular.forEach(c.find("a"),function(a){a=angular.element(a);var c=a.parent();if(a.hasClass("dropdown-link")){var e=c.parent(),f=e.prev();-1!==b.indexOf(a.attr("href"))?(d=!0,f.addClass("active")):d||f.removeClass("active")}else-1!==b.indexOf(a.attr("href"))?a.parent().addClass("active"):a.parent().removeClass("active")})})}}}]),angular.module("ecosenseUiApp").factory("authService",["$cookies","$rootScope",function(a,b){var c=null;return{setToken:function(d){b.loggedIn=!0;var e=new Date;a.put("userToken",d,e.getDate()+14),c=d},getToken:function(){return c},clearToken:function(){a.remove("userToken"),c=null},logout:function(){a.remove("userToken"),c=null,b.loggedIn=!1,delete b.user}}}]),angular.module("ecosenseUiApp").directive("logoutbutton",["$rootScope","apiService","authService","$location",function(a,b,c,d){return{templateUrl:"views/partials/logoutbutton.html",restrict:"E",link:function(a,b,e){a.logout=function(){c.logout(),d.path("/")}}}}]),angular.module("ecosenseUiApp").directive("loadingBar",["$rootScope",function(a){return{templateUrl:"views/partials/loadingbar.html",restrict:"E",link:function(b,c,d){b.isRouteLoading=!1,console.log("hello"),a.$on("$routeChangeStart",function(){b.isRouteLoading=!0,console.log("Route starting, showing loading bar ")}),a.$on("$routeChangeSuccess",function(){b.isRouteLoading=!1,console.log("Route finished, hiding loading bar ")})}}}]),angular.module("ecosenseUiApp").factory("userModel",function(){var a=null;return{getName:function(){return a.name},getUser:function(){return a},setUser:function(b){a=b}}}),angular.module("ecosenseUiApp").directive("datetimepicker",["$timeout",function(a){return{require:"?ngModel",restrict:"EA",scope:{datetimepickerOptions:"@",onDateChangeFunction:"&",onDateClickFunction:"&"},link:function(b,c,d,e){c.on("dp.change",function(){a(function(){var a=c.data("DateTimePicker");e.$setViewValue(a.date()),b.onDateChangeFunction()})}),c.on("click",function(){b.onDateClickFunction()}),e.$render=function(){if(e&&e.$viewValue){var a=e.$viewValue;c.data("DateTimePicker").date(a)}},c.datetimepicker(b.$eval(d.datetimepickerOptions))}}}]),angular.module("ecosenseUiApp").factory("collectionModel",["$rootScope",function(a){var b=null;return{setCurrentCollection:function(a){b=a},getCurrentCollection:function(){return b}}}]),angular.module("ecosenseUiApp").directive("dashboardsidebar",function(){return{templateUrl:"views/directives/dashboardsidebar.html",restrict:"E",link:function(a,b,c){}}}),angular.module("ecosenseUiApp").run(["$templateCache",function(a){a.put("views/directives/dashboardsidebar.html",'<div class="dashboard-sidebar col-lg-2"> <ul bs-active-link> <li> <a ng-href="#/dashboard">Dashboard</a> </li> <li> <a href="">Notifications</a> </li> <li> <a ng-href="#/collection/create">New collection</a> </li> <li> <a ng-href="#/dropoff/find">New dropoff</a> </li> <li> <a href="">Edit profile</a> </li> <li> <a href="">Settings</a> </li> <li> <a href="">Logout</a> </li> </ul> </div>'),a.put("views/main.html",'<div id="landing-1"> <img src="images/landing/main-1.e469f682.png" alt="Landing Image 1"> <div class="landing-content row row-eq-height"> <div class="col-xs-6"> </div> <div class="col-xs-6"> <div class="landing-1-right col-xs-offset-1 col-xs-10"> Remove your phones from your drawer and make the world a better place. </div> <div class="col-xs-1"></div> </div> </div> </div> <div class="row"> <div id="landing-2-arrow-container"> <span class="landing-header">Join the fight against the drawer.</span> </div> </div> <div id="landing-2"> <div class="row row-eq-height"> <div class="col-xs-4"> </div> <div class="col-xs-8"> <div class="row"> <span class="landing-header-bold">What do we do?</span> </div> <div class="row"> <span class="landing-header-small"> SeeThru is a platform that encourages the responsible recycling of phones. </span> </div> <div class="row"> <span class="landing-body-text col-xs-offset-2 col-xs-8"> Millions of phones sleeping in drawers contain materials that can be used to build new phones, saving lots of the Earthâ€™s natural resources. </span> <div class="col-xs-2"></div> </div> </div> </div> <div class="row no-gutter row-eq-height"> <div class="col-xs-4"> <img src="images/landing/drawer-1.76e58cbc.png" alt="Drawer"> </div> <div class="col-xs-4"> <img src="images/landing/drawer-1.76e58cbc.png" alt="Drawer"> </div> <div class="col-xs-4"> <img src="images/landing/drawer-1.76e58cbc.png" alt="Drawer"> </div> </div> <div class="row no-gutter landing-3-final-row row-eq-height"> <div class="col-xs-8"> <div class="landing-2-left"> By removing as many old phones as possible from drawers, we can make the use of mobile phones more sustainable. </div> </div> <div class="col-xs-4"> </div> </div> </div> <div id="landing-3"> <div class="row no-gutter row-eq-height"> <div class="col-xs-6 gold"> <div class="gold-container"> <div class="gold-title-container"> <div class="gold-background-container"> <span class="gold-title"> Did you know there is gold in your waste? </span> </div> </div> <div class="gold-title-container"> <br> <span class="gold-subtitle"> MORE STATS </span> </div> </div> </div> <div class="col-xs-6 no-vertical-gutter"> <div class="row row-eq-height"> <div class="col-xs-6" style="background-color:#000"> <img src="images/testimonials.0b5495be.png" style="width:100%"> </div> <div id="share-drawer" class="col-xs-6"> <div class="share-drawer-container"> <a class="share-drawer-outline"> SHARE YOUR DRAWER </a> </div> </div> </div> <div class="row row-eq-height"> <div id="seethru-map" class="col-xs-12"> <div class="map-text"> See Thru </div> </div> </div> </div> </div> <div class="row no-gutter row-eq-height"> <div class="col-xs-6"> <div class="quiz-small-title">TEST YOUR KNOWLEDGE WITH OUR</div> <div class="quiz-big-title">QUIZ</div> </div> <div class="col-xs-6"> </div> </div> </div>'),a.put("views/partials/citizendashboard.html",'<div class="col-lg-12"> <div class="dashboard-sidebar col-lg-2"> <ul> <li> <a class="active" ng-href="#/dashboard">Dashboard</a> </li> <li> <a href="">Notifications</a> </li> <li> <a ng-href="#/collection/create">New collection</a> </li> <li> <a ng-href="#/dropoff/find">New dropoff</a> </li> <li> <a href="">Edit profile</a> </li> <li> <a href="">Settings</a> </li> <li> <a href="">Logout</a> </li> </ul> </div> <div class="col-lg-6"> <div class="profile-info-container col-lg-12"> <div class="dashboard-image col-lg-6" ng-switch="data.thumbnail_url"> <img ng-switch-when="undefined" ng-src=""> <img ng-switch-default ng-src="{{baseURL}}{{data.thumbnail_url}}"> </div> <div class="profile-details col-lg-6"> <span class="username">{{data.first_name}} {{data.last_name}}</span> <div class="profile-details-row"> <div class="image-container"> <img src="images/icons/clock.svg"> </div> <span class="row-text"> December 2015 </span> </div> <div class="profile-details-row"> <div class="image-container"> <img src="images/icons/marker.svg"> </div> <span class="row-text"> Koramangla </span> </div> <div class="profile-details-row"> <div class="image-container"> <img src="images/icons/language.svg"> </div> <span class="row-text"> English </span> </div> </div> </div> <div class="collections-title col-lg-12"> <span>Collections</span> </div> <div class="collections-container col-lg-12"> <ul class="collections-list"> <li class="future"> <div class="icon"> <img src="images/icons/battery-future.svg"> </div> <span class="collection-info"> 01.01.16, 09:00 AM at Koramangla </span> </li> <li> <div class="icon"> <img src="images/icons/disk.svg"> </div> <span class="collection-info"> 29.11.15, 11:00 AM at Koramangla </span> </li> <li> <div class="icon"> <img src="images/icons/cable.svg"> </div> <span class="collection-info"> 27.11.15, 03:00 PM at Koramangla </span> </li> </ul> </div> </div> </div>'),a.put("views/partials/collectordashboard.html","<div>{{scope.data}}</div>"),a.put("views/partials/loadingbar.html",'<div ng-if="isRouteLoading" style="width: 200px"> <div class="progress progress-striped active"> <div class="bar" style="width:100px"></div> </div> </div>'),a.put("views/partials/loginform.html",'<div class="auth-form-container"> <form name="loginForm" novalidate class="simple-form" autocomplete="off"> <div class="row"> <div ng-class="{ \'has-error\' : (loginForm.$submitted || loginForm.email.$touched) && loginForm.email.$error.required }" class="form-group col-lg-12"> <input type="text" class="form-control" ng-model="user.email" name="email" required placeholder="Email address" autocomplete="off"> </div> <div ng-class="{ \'has-error\' : (loginForm.$submitted || loginForm.password.$touched) && loginForm.password.$error.required }" class="form-group col-lg-12"> <input type="password" class="form-control" ng-model="user.password" name="password" required placeholder="Password" autocomplete="off"> </div> <div class="form-group col-lg-12 login-submit-row"> <button type="submit" ng-click="submit(user, loginForm)" ng-disabled="loading" class="btn btn-default auth-submit">Login</button> </div> </div> <div class="row"> <div ng-switch="incorrectPassword"> <div ng-switch-when="true"> Incorrect email or password </div> </div> <div ng-switch="serverError"> <div ng-switch-when="true"> An error occurred. Please try again </div> </div> </div> </form> </div>'),a.put("views/partials/logoutbutton.html",'<a ng-click="logout()" href="">Logout</a>'),a.put("views/partials/navbar.html",'<ul class="nav navbar-nav" bs-active-link> <li> <a href="#/">Home</a> <span class="nav-accent"></span> </li> <li> <a ng-href="#/about">About Us</a> <span class="nav-accent"></span> </li> <li> <a ng-href="#/unearth">Learn With Us</a> <span class="nav-accent"></span> </li> <li class="nav-highlight"> <a ng-href="#/unearth">Take Action</a> </li> </ul>')}]);